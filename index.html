<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RSQ Key System</title>

<style>
body {
  margin:0;
  background:#0b0e14;
  font-family:system-ui;
  color:white;
}

.hidden { display:none; }

.panel {
  width:520px;
  background:#141822;
  border-radius:18px;
  padding:22px;
  box-shadow:0 0 60px rgba(0,120,255,.3);
  margin:auto;
  margin-top:10vh;
}

button,input,select {
  width:100%;
  padding:12px;
  margin-top:8px;
  border-radius:8px;
  border:none;
  font-size:14px;
}

input,select {
  background:#0b0f18;
  color:white;
  border:1px solid #222;
}

button {
  background:linear-gradient(135deg,#4f7cff,#3fd2ff);
  font-weight:bold;
  cursor:pointer;
}

button.danger {
  background:linear-gradient(135deg,#ff3b30,#ff453a);
}

button.secondary {
  background:linear-gradient(135deg,#ff8a00,#ffb300);
}

.status { text-align:center;margin-top:8px;font-size:13px; }

.adminFull {
  position:fixed;
  inset:0;
  background:#0b0e14;
  padding:20px;
  overflow:auto;
}

.keyRow {
  background:#111625;
  border-radius:10px;
  padding:10px;
  margin-bottom:10px;
  font-size:12px;
}
</style>
</head>

<body>

<!-- USER PANEL -->
<div id="userPanel" class="panel">
  <h2 style="text-align:center">üîê RSQ Key System</h2>

  <input id="userid" placeholder="Roblox UserId">
  <button id="genBtn">Generate Key</button>

  <div id="keyBox" class="hidden"></div>
  <div id="timer"></div>
  <div id="status" class="status"></div>

  <button id="adminBtn" class="danger">üëë Admin Panel</button>
  <input id="adminInput" class="hidden" placeholder="Admin Master Key">
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" class="adminFull hidden">
  <h2>üëë ADMIN PANEL</h2>
  <button onclick="exitAdmin()">Exit Admin Panel</button>

  <hr>

  <h3>Create Infinite Key</h3>
  <input id="infUser" placeholder="UserId">
  <button onclick="createInfinite()">Generate Infinite Key</button>

  <hr>

  <h3>Ban UserId</h3>
  <input id="banUser" placeholder="UserId">
  <select id="banTime">
    <option value="3600">1 Hour</option>
    <option value="86400">1 Day</option>
    <option value="604800">1 Week</option>
    <option value="2592000">1 Month</option>
    <option value="31536000">1 Year</option>
  </select>
  <button class="danger" onclick="banUser()">Ban User</button>

  <hr>

  <h3>Key Logs</h3>
  <div id="logs"></div>
</div>

<script>
/* CONFIG */
const BIN_ID = "694c4aefae596e708faef157";
const JSONBIN_KEY = "$2a$10$DgQd.qgYLB2nv9e9ZFktKeUUkzZfmqPnL4Fk7JLvnN/ASlctW.8Cu";
const ADMIN_MASTER_KEY = "roblox";
const KEY_LIFE = 86400;

/* HELPERS */
const now = () => Math.floor(Date.now()/1000);
const makeKey = () => "RSQ-" + crypto.randomUUID().replace(/-/g,"").slice(0,20).toUpperCase();

/* JSONBIN */
async function getData(){
  const r = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`);
  const j = await r.json();
  return j.record;
}
async function saveData(data){
  await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`,{
    method:"PUT",
    headers:{
      "Content-Type":"application/json",
      "X-Master-Key":JSONBIN_KEY
    },
    body:JSON.stringify(data)
  });
}

/* USER */
genBtn.onclick = async ()=>{
  const uid = userid.value.trim();
  if(!/^\d+$/.test(uid)) return status.textContent="‚ùå Invalid UserId";

  const data = await getData();
  data.bans ||= {};
  if(data.bans[uid] && data.bans[uid] > now())
    return status.textContent="üö´ You are banned";

  data.keys ||= {};
  for(const k in data.keys){
    const d = data.keys[k];
    if(d.userId==uid && (d.expires===0 || d.expires>now())){
      navigator.clipboard.writeText(k);
      status.textContent="‚úÖ Key copied";
      return;
    }
  }

  const key = makeKey();
  data.keys[key] = {userId:Number(uid),expires:now()+KEY_LIFE};
  await saveData(data);

  navigator.clipboard.writeText(key);
  status.textContent="‚úÖ New key generated";
};

/* ADMIN LOGIN */
adminBtn.onclick=()=>adminInput.classList.toggle("hidden");

adminInput.onchange=()=>{
  if(adminInput.value!==ADMIN_MASTER_KEY)
    return alert("Invalid admin key");

  userPanel.classList.add("hidden");
  adminPanel.classList.remove("hidden");
  renderLogs();
};

/* ADMIN ACTIONS */
async function renderLogs(){
  const data = await getData();
  logs.innerHTML="";
  data.keys ||= {};
  for(const k in data.keys){
    const d = data.keys[k];
    const div=document.createElement("div");
    div.className="keyRow";
    div.innerHTML=`
<b>${k}</b><br>
UserId: ${d.userId}<br>
Status: ${d.expires===0?"‚ôæÔ∏è INFINITE":d.expires>now()?"‚úÖ ACTIVE":"‚ùå EXPIRED"}
`;
    const renew=document.createElement("button");
    renew.textContent="Renew 24h";
    renew.onclick=async()=>{
      d.expires=now()+KEY_LIFE;
      await saveData(data);
      renderLogs();
    };

    const del=document.createElement("button");
    del.textContent="Delete";
    del.className="danger";
    del.onclick=async()=>{
      delete data.keys[k];
      await saveData(data);
      renderLogs();
    };

    div.append(renew,del);
    logs.appendChild(div);
  }
}

async function createInfinite(){
  const uid=infUser.value.trim();
  if(!uid) return;
  const data=await getData();
  const key=makeKey();
  data.keys[key]={userId:Number(uid),expires:0};
  await saveData(data);
  renderLogs();
}

async function banUser(){
  const uid=banUser.value.trim();
  const dur=Number(banTime.value);
  const data=await getData();
  data.bans ||= {};
  data.bans[uid]=now()+dur;
  await saveData(data);
  renderLogs();
}

function exitAdmin(){
  adminPanel.classList.add("hidden");
  userPanel.classList.remove("hidden");
}
</script>
</body>
</html>
