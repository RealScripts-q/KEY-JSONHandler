<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>RSQ Key System</title>
<style>
body{
  background:#0b0d14;
  color:white;
  font-family:Segoe UI;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.box{
  width:400px;
  background:#12121a;
  padding:20px;
  border-radius:16px;
}
input,button{
  width:100%;
  height:36px;
  margin-top:10px;
  border-radius:10px;
  border:none;
}
input{background:#0e0e16;color:white;padding:10px;}
button{background:#0080ff;color:white;font-weight:600;cursor:pointer;}
.status{text-align:center;margin-top:12px;font-size:13px;}
.ok{color:#46ff8c}
.err{color:#ff5050}
</style>
</head>

<body>
<div class="box" id="ui">
  <h3 style="text-align:center;color:#50c8ff">üîê RSQ Key System</h3>
  <input id="key" placeholder="Paste your key">
  <button onclick="verify()">Verify Key</button>
  <div id="status" class="status">Waiting for key...</div>
</div>

<script>
/* ================= CONFIG ================= */

const USER_ID = 123456789; // simulate Roblox UserId
const RECHECK_INTERVAL = 15000;

// CORS proxy
const JSON_URL =
"https://api.allorigins.win/raw?url=" +
encodeURIComponent("https://api.jsonbin.io/v3/b/694c4aefae596e708faef157/latest");

/* ================= STATE ================= */

let currentKey = null;

/* ================= HELPERS ================= */

function setStatus(msg, cls=""){
  const s = document.getElementById("status");
  s.textContent = msg;
  s.className = "status " + cls;
}

async function fetchData(){
  try{
    const r = await fetch(JSON_URL);
    const j = await r.json();
    return j.record;
  }catch{
    return null;
  }
}

/* ================= VALIDATION ================= */

function checkKey(key, data){
  const now = Math.floor(Date.now()/1000);

  if(data.bans && data.bans[USER_ID] && data.bans[USER_ID] > now){
    alert("üö´ You were banned");
    location.reload();
    return "BANNED";
  }

  if(!data.keys || !data.keys[key]) return "DELETED";

  const info = data.keys[key];

  if(Number(info.userId) !== USER_ID) return "INVALID";

  if(info.expires !== 0 && info.expires < now) return "EXPIRED";

  return "VALID";
}

/* ================= VERIFY ================= */

async function verify(){
  const key = document.getElementById("key").value.trim();
  if(!key) return;

  setStatus("Checking...");

  const data = await fetchData();
  if(!data){
    setStatus("‚ö†Ô∏è Network error","err");
    return;
  }

  const state = checkKey(key,data);

  if(state !== "VALID"){
    setStatus(
      state === "EXPIRED" ? "‚è∞ Key expired" : "‚ùå Invalid key",
      "err"
    );
    return;
  }

  currentKey = key;
  localStorage.setItem("rsq_key", key);

  setStatus("‚úÖ Key valid","ok");
  document.getElementById("ui").style.display="none";

  startLiveCheck();
}

/* ================= LIVE RECHECK ================= */

function startLiveCheck(){
  setInterval(async ()=>{
    if(!currentKey) return;
    const data = await fetchData();
    if(!data) return;

    const state = checkKey(currentKey,data);
    if(state === "VALID") return;

    currentKey = null;
    document.getElementById("ui").style.display="block";
    setStatus("‚ùå Key revoked","err");

  }, RECHECK_INTERVAL);
}

/* ================= AUTO LOAD ================= */

const saved = localStorage.getItem("rsq_key");
if(saved){
  document.getElementById("key").value = saved;
  verify();
}
</script>
</body>
</html>
